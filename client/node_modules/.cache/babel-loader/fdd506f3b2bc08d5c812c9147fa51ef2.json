{"ast":null,"code":"import { takeLatest, put, all, call } from 'redux-saga/effects';\nimport { ACTION_TYPES } from '../action-types';\nimport { auth, provider, createUserProfileDoc, getCurrentUser } from '../../firebase/utils';\nimport { signInFailure, signInSuccess, signOutSuccess, signOutFailure } from './user-actions'; // UTILITIES -----------------------------------------------------------------\n\nfunction* getSnapshotFromUserAuth(userAuth) {\n  try {\n    const userRef = yield call(createUserProfileDoc, userAuth);\n    const userSnapshot = yield userRef.get();\n    yield put(signInSuccess({\n      id: userSnapshot.id,\n      ...userSnapshot.data()\n    }));\n  } catch (error) {\n    yield put(signInFailure(error.message));\n  }\n} // Google Sign In------------------------------------------------------------------------------------\n\n\nfunction* onGoogleSignInStart() {\n  yield takeLatest(ACTION_TYPES.GOOGLE_SIGN_IN_START, signInWithGoogle);\n}\n\nfunction* signInWithGoogle() {\n  try {\n    const {\n      user\n    } = yield auth.signInWithPopup(provider);\n    yield getSnapshotFromUserAuth(user);\n  } catch (error) {\n    yield put(signInFailure(error.message));\n  }\n} // User Sign In------------------------------------------------------------------------------------\n\n\nfunction* onEmailSignInStart() {\n  yield takeLatest(ACTION_TYPES.EMAIL_SIGN_IN_START, signInWithEmail);\n}\n\nfunction* signInWithEmail(action) {\n  try {\n    const {\n      email,\n      password\n    } = action.payload;\n    const {\n      user\n    } = yield auth.signInWithEmailAndPassword(email, password);\n    yield getSnapshotFromUserAuth(user);\n  } catch (error) {\n    yield put(signInFailure(error.message));\n  }\n} // USER SESSION CHECKING---------------------------------------------------------------------------\n\n\nfunction* onCheckUserSession() {\n  yield takeLatest(ACTION_TYPES.CHECK_USER_SESSION, checkIfUserIsAuthenticated);\n}\n\nfunction* checkIfUserIsAuthenticated() {\n  try {\n    const userAuth = yield getCurrentUser();\n\n    if (!userAuth) {\n      return;\n    }\n\n    yield getSnapshotFromUserAuth(userAuth);\n  } catch (error) {\n    yield put(signInFailure(error.message));\n  }\n} // USER SIGN OUT---------------------------------------------------------------------------\n\n\nfunction* onSignOutStart() {\n  yield takeLatest(ACTION_TYPES.SIGN_OUT_START, userSignOut);\n}\n\nfunction* userSignOut() {\n  try {\n    yield auth.signOut();\n    yield put(signOutSuccess());\n  } catch (error) {\n    yield put(signOutFailure(error.message));\n  }\n}\n\nexport function* userSagas() {\n  yield all([call(onCheckUserSession), call(onGoogleSignInStart), call(onEmailSignInStart), call(onSignOutStart)]);\n}","map":{"version":3,"sources":["/Users/jasoncarrillo/Documents/Coding/React Projects/crwn-clothing/src/redux/user/user.sagas.js"],"names":["takeLatest","put","all","call","ACTION_TYPES","auth","provider","createUserProfileDoc","getCurrentUser","signInFailure","signInSuccess","signOutSuccess","signOutFailure","getSnapshotFromUserAuth","userAuth","userRef","userSnapshot","get","id","data","error","message","onGoogleSignInStart","GOOGLE_SIGN_IN_START","signInWithGoogle","user","signInWithPopup","onEmailSignInStart","EMAIL_SIGN_IN_START","signInWithEmail","action","email","password","payload","signInWithEmailAndPassword","onCheckUserSession","CHECK_USER_SESSION","checkIfUserIsAuthenticated","onSignOutStart","SIGN_OUT_START","userSignOut","signOut","userSagas"],"mappings":"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","sourcesContent":["import { takeLatest, put, all, call } from 'redux-saga/effects';\nimport { ACTION_TYPES } from '../action-types';\nimport { auth, provider, createUserProfileDoc, getCurrentUser } from '../../firebase/utils';\nimport { signInFailure, signInSuccess, signOutSuccess, signOutFailure } from './user-actions';\n// UTILITIES -----------------------------------------------------------------\nfunction* getSnapshotFromUserAuth(userAuth) {\n    try {\n        const userRef      = yield call(createUserProfileDoc, userAuth);\n        const userSnapshot = yield userRef.get();\n        yield put(\n            signInSuccess({id: userSnapshot.id, ...userSnapshot.data()})\n        );\n    } catch (error) {\n        yield put(signInFailure(error.message))\n    }\n}\n\n\n\n// Google Sign In------------------------------------------------------------------------------------\nfunction* onGoogleSignInStart() {\n    yield takeLatest(\n        ACTION_TYPES.GOOGLE_SIGN_IN_START,\n        signInWithGoogle\n    );\n}\nfunction* signInWithGoogle() {\n    try {\n        const { user } = yield auth.signInWithPopup(provider);\n        yield getSnapshotFromUserAuth(user);\n    } catch(error) {\n        yield put(signInFailure(error.message))\n    }\n}\n\n\n\n \n// User Sign In------------------------------------------------------------------------------------\nfunction* onEmailSignInStart() {\n    yield takeLatest(\n        ACTION_TYPES.EMAIL_SIGN_IN_START,\n        signInWithEmail\n    )\n}\nfunction* signInWithEmail(action) {\n    try {\n        const { email, password } = action.payload;\n        const { user }            = yield auth.signInWithEmailAndPassword(email, password);\n        yield getSnapshotFromUserAuth(user);   \n    } catch (error) {\n        yield put(signInFailure(error.message))\n    }\n}\n\n\n\n\n// USER SESSION CHECKING---------------------------------------------------------------------------\nfunction* onCheckUserSession() {\n    yield takeLatest(\n        ACTION_TYPES.CHECK_USER_SESSION,\n        checkIfUserIsAuthenticated\n    )\n}\nfunction* checkIfUserIsAuthenticated() {\n    try {\n        const userAuth = yield getCurrentUser();\n        if (!userAuth) {\n            return\n        }\n        yield getSnapshotFromUserAuth(userAuth);\n    } catch(error) {\n        yield put(signInFailure(error.message));\n    }\n}\n\n\n// USER SIGN OUT---------------------------------------------------------------------------\nfunction* onSignOutStart() {\n    yield takeLatest(\n        ACTION_TYPES.SIGN_OUT_START,\n        userSignOut\n    )\n}\nfunction* userSignOut() {\n    try {\n        yield auth.signOut();\n        yield put(signOutSuccess())\n    } catch(error) {\n        yield put(signOutFailure(error.message))\n    }\n}\n\n\n\n\n\nexport function* userSagas() {\n    yield all([\n        call(onCheckUserSession),\n        call(onGoogleSignInStart),\n        call(onEmailSignInStart),\n        call(onSignOutStart)\n    ]);\n}"]},"metadata":{},"sourceType":"module"}